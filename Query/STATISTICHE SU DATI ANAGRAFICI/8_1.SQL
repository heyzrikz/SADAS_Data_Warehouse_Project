--Età media dei dipendenti raggruppati per dipartimento

SELECT ROUND(AVG(DATEDIFF('YY', data_nascita,TODAY)), 0) AS eta_media,DIPARTIMENTO
FROM (SELECT DISTINCT CODICE_FISCALE, DATA_NASCITA,DIPARTIMENTO FROM ANAGRAFICA
GROUP BY CODICE_FISCALE,DATA_NASCITA,DIPARTIMENTO
)
GROUP BY DIPARTIMENTO
ORDER BY ETA_MEDIA DESC
