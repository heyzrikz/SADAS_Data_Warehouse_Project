-- Somma di tutti gli stipendi annuali negli ultimi 3 anni raggruppati per dipendente

SELECT CODICE_FISCALE,NOME,COGNOME,SUM(STIPENDIO) AS STIPENDIO_TOTALE_3YY,SUM(STIPENDIO_NETTO) AS STIPENDIO_TOTALE_NETTO_3YY
FROM(SELECT
	 CODICE_FISCALE,NOME,COGNOME,ANNO,STIPENDIO,STIPENDIO_NETTO,DATEPART('YY',DATEADD('YY',-2,TODAY))AS A

FROM
	 CEDOLINI WHERE ANNO >= A 
)
GROUP BY CODICE_FISCALE,NOME,COGNOME