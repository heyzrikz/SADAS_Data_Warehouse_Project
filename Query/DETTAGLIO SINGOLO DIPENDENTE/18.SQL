--Ordina per ogni dipartimento i dipendenti più qualificati di ogni filiale
SELECT CODICE_FISCALE,NOME,COGNOME,MAX(LIVELLO) AS LIVELLO,FILIALE,DIPARTIMENTO FROM(
SELECT CODICE_FISCALE,NOME,COGNOME,LIVELLO,FILIALE,DIPARTIMENTO FROM CEDOLINI_FILIALE_DIPARTIMENTO
WHERE ANNO= DATEPART('YY',TODAY) AND FILIALE='1' AND DIPARTIMENTO = 'Produzione'  --Filtra per filiale e dipartimento
)
GROUP BY CODICE_FISCALE,NOME,COGNOME,FILIALE,DIPARTIMENTO
ORDER BY LIVELLO DESC

